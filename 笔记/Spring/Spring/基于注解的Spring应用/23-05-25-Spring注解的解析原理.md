# Spring注解的解析原理

## 生命周期回顾

![1685013281903](image/23-05-25-Spring注解的解析原理/1685013281903.png)

## xml和注解方式回顾

![1685013369221](image/23-05-25-Spring注解的解析原理/1685013369221.png)

## 扫描步骤

### xml扫描流程

1.注册自定义命名空间的标签解析器

2.利用自定义命名空间的component-scan标签功能进行解析

![1685079602993](image/23-05-25-Spring注解的解析原理/1685079602993.png)

3.执行doScan方法

![1685014237673](image/23-05-25-Spring注解的解析原理/1685014237673.png)

4.利用ClassPathBeanDefinitionScanner.class的doScan方法解析注解，然后逐个注册到BeanDefinitionMap

![1685079516760](image/23-05-25-Spring注解的解析原理/1685079516760.png)

### 注解扫描流程

![1685079686971](image/23-05-25-Spring注解的解析原理/1685079686971.png)

1.创建一个注解读取器

![1685079837494](image/23-05-25-Spring注解的解析原理/1685079837494.png)

2.注册一个注解配置的Processors

![1685079927337](image/23-05-25-Spring注解的解析原理/1685079927337.png)

3.注册注解解析器

由于部分注解执行时机不同，可能在实例化前（@Commponent），也有可能在实例化之后（@Autowired），所以注册时机也不同

![1685081517666](image/23-05-25-Spring注解的解析原理/1685081517666.png)

![1685083457980](image/23-05-25-Spring注解的解析原理/1685083457980.png)

![1685083503398](image/23-05-25-Spring注解的解析原理/1685083503398.png)

4.同xml解析一样，也是使用ClassPathBeanDefinitionScanner.class的doScan解析注解注册到BeanDefinitionMap

![1685084376852](image/23-05-25-Spring注解的解析原理/1685084376852.png)

## 总结

![1685084677647](image/23-05-25-Spring注解的解析原理/1685084677647.png)

![1685084684864](image/23-05-25-Spring注解的解析原理/1685084684864.png)

![1685084727482](image/23-05-25-Spring注解的解析原理/1685084727482.png)
