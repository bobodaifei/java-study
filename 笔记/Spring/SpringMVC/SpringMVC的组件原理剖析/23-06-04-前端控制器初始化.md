# 前端控制器初始化

![1685883416205](image/23-06-04-前端控制器初始化/1685883416205.png)

![1685886136256](image/23-06-04-前端控制器初始化/1685886136256.png)

![1685886161310](image/23-06-04-前端控制器初始化/1685886161310.png)

此处的尝试设置为父子容器关系

![1685927395303](image/23-06-04-前端控制器初始化/1685927395303.png)

如果mvc容器存在

![1685927601536](image/23-06-04-前端控制器初始化/1685927601536.png)

如果mvc容器不存在

![1685927653450](image/23-06-04-前端控制器初始化/1685927653450.png)

![1685927438381](image/23-06-04-前端控制器初始化/1685927438381.png)

configureAndRefreshWebApplicationContext(***);

不论是新创建的还是已经存在的mvc容器，都要进行配置和刷新。wac.refresh()：执行一系列容器初始化

![1685927816824](image/23-06-04-前端控制器初始化/1685927816824.png)

finishRefresh();完成容器的初始化

![1685927963753](image/23-06-04-前端控制器初始化/1685927963753.png)

publishEvent(new ContextRefreshedEvent(this)); 发布一个容器刷新完毕的事件（spring体系的监听器机制）

![1685928036993](image/23-06-04-前端控制器初始化/1685928036993.png)

此处会被监听器获取到上面发布的事件，执行onApplicationEvent方法

![1685928290530](image/23-06-04-前端控制器初始化/1685928290530.png)

然后执行DispatcherServlet的onRefresh方法，进行注册九大组件。如果指定了组件，会只加载指定的，反之加载默认的

![1685928511226](image/23-06-04-前端控制器初始化/1685928511226.png)

此处init在执行前就已经将拦截器，控制层等的引用进行维护了

![1685940437426](image/23-06-04-前端控制器初始化/1685940437426.png)

![1685940472485](image/23-06-04-前端控制器初始化/1685940472485.png)
